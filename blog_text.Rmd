---
title: "Blog Text"
author: "Hannes Pieper"
date: "4/21/2021"
output:
  md_document: default
  html_document: default
knit: (function(inputFile, encoding) {
  rmarkdown::render(inputFile, encoding = encoding, output_format = "all") })
---

```{r setup, include=FALSE}
# where figures for rendering the document are saved
knitr::opts_chunk$set(
  fig.path = "output/images/blog_text_figs/"
)

# packages
library(dplyr) # for data preparation
library(tidyr) # for data preparation
library(stringr) # for data preparation
library(tidytext) # for rearrange facet + bar charts
library(ggplot2) # for graphs
library(ggpubr) # for graphs next to each other
library(ggraph) # for the network graph
library(igraph) # for the network graph

# graph themes
source("./scripts/themes.R")

```

# Critical Graphs: Some Shenanigans with Critical Role Season 1 subtitles and other data

"[...] It's your turn to roll." It's with that phrase that many of the episodes of Critical Role start. What is Critical Role you ask? To use their words: It's a bunch of nerdy ass voice actors, who sit around and play dungeons and dragons. And they are successful at that. Thousands around the world tune in to watch them live and millions view their shenanigans later on Youtube. What makes it unique is that nothing is scripted. There is nobody writing out an episode beforehand. Everything is possible and only happens in the imagination of the players and the viewers. Whatever happens is up to the players and dice rolls to decide. That's what makes it so intriguing to watch. It also makes it interesting for some nerdy ass data analyses. So lets do these here. But be aware: spoilers ahead.

The first question for every data analysis is the question of which data to use. Luckily, the community provided subtitles for every episode of the first season. These can be used to create the data. For example, a typical episode might start with the game master Metthew Mercer saying: "Hello everybody and good evening. Welcome to Critical Role [...]". In the subtitle file this looks as follows:

> 00:00:00,500 --\> 00:00:04,043 MATT: Hello, everyone and good evening. Welcome to Critical Role, a show where a bunch of us

Where the numbers indicate the time a subtitle is shown on the screen. Doing some data manipulation this can be turned this into some nicer format. At this point I should mention that I am not the first to create a data set using the data. Rameshkumar and Bailey (2020) used the data in a published paper already. However, while it includes some additional information compared to my data set, it omits the time dimension of the data. Also creating my own data set served as a good practice in data cleaning for myself.

As the subtitles were written by volunteers, not everybody followed the same naming convention for the person speaking. For example, if the game master is speaking as an NPC, this could be written in the subtitles as the name of the NPC or as Matt. Additionally, as is inevitable when typing out such a lengthy and quickly spoken text, people make mistakes. Which brings us to the first interesting question to ask: which actor got misspelled the most in the subtitles?

The person, who got miss spelled the most was Marisha Ray. These include, for example, Marishaia or Marishaaaa.

```{r miss_spellings, echo = FALSE}
miss_spells <- read.csv(file = "./data/data_for_graphs/miss_spells.csv")

miss_spells %>%
  ggplot(aes(x = reorder(Actor, count), y = count, fill = miss_spelling)) +
  geom_bar(position = "dodge", stat = "identity") +
  coord_flip() +
  scale_y_continuous(
    expand = c(0, 0),
    position = "right",
  ) +
  scale_fill_manual(
    breaks = c("amount miss spellings", "types miss spellings"),
    values = c("#1b9e77", "#ffa600"),
    labels = c("Amount Miss Spellings", "Different Variants Miss Spellings")
  ) +
  labs(
    title = "Miss Spellings per Actor",
    caption = "Source: Critical-Role-Subtitles"
  ) +
  bar_chart_theme() +
  theme(
    legend.position = "bottom",
    legend.text = element_text(size = 5.5),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "line"),
    legend.key = element_blank(),
    legend.margin = margin(t = 0, unit = "cm")
  )

ggsave("./output/images/graphs/miss_spells.jpg", width = 4, height = 3)
```

However, not everybody has the same chance to be misspelled. The direct comparison may be unfair for two reasons: first, not every actor was present for all episodes. Second, not every actor spoke for the same amount of time. While Matt, as the game master has to be present for every episode and has to describe elaborate scenery, other actors can be give short answers or sit out an episode. So let's look of both of these numbers in turn.

Looking at the attendance by the players some difference become apparent. First of all, it becomes obvious that most players are also present most of the time. Out of the eight players, five didn't miss more than 5 episodes. Additionally, Sam Riegel only missed 9. Meanwhile, Ashley Johnson didn't even attend half of the episodes. Likewise, Orion Acaba did only participate in every fifth episode. The main reason for the absence of the latter is the fact that he dropped out of the project after only a little more than 25 episodes were filmed. Hence, it seems reasonable that both Ashley and Orion got misspelled less compared to the rest of the cast. Additionally, it shows that about one in five episodes had guests joining the show.

```{r attendence, echo = FALSE}
# read in data
attendance <- read.csv(file = "./data/data_for_graphs/attendance.csv")

# create graph
attendance %>%
  ggplot(aes(x = reorder(actor, episodes), y = episodes)) +
  geom_bar(stat = "identity", fill = "#1b9e77") +
  coord_flip() +
  scale_y_continuous(
    expand = c(0, 0),
    position = "right",
    breaks = c(0, 25, 50, 50, 75, 100, 115),
    limits = c(0, 115)
  ) +
  labs(
    title = "Attendence by Actor",
    subtitle = "Number of Episodes, in which an Actor was present",
    caption = "Source: Critical-Role-Subtitles"
  ) +
  bar_chart_theme()

# save graph
ggsave("./output/pictures/graphs/attendance.jpg", width = 4, height = 3)
```

Let's look at the time different actor speak. Looking at the data, it becomes obvious that Matt speaks the most. This hardly is surprising. After all, a game master has to describe how everything looks and feels. Additionally, he has to act out non player characters and their reaction to the actions of the players. Lastly, he has to describe how the actions of the players are playing out in the imaginary world. In total he speaks three quarters of the time and uses fifty percent of all words spoken. Similarly to the misspellings, Marisha tops list in terms of time speaking. However, in terms of words spoken Laura Bailey jumps indicating that she speaks quicker compared to the rest of the cast. Moreover, it becomes obvious that both Ashley and Orion speak around the same amount as all guests of the show combined. However, there is a catch to these numbers. Namely, that not all everything that is said is transcribed in the subtitles. Sometimes many people speak at the same time. In that case not everything is recorded in the subtitles. Moreover, the time people speak can only be seen as a rough estimates. The reason for this is is the fact that it is measured by the time segments of the subtitles are shown. For example, a long description from Matt may span over 30 seconds. These 30 seconds may be split into 5 subtitle segments, which do not incorporate pauses. Additionally, descriptions like "(everybody is laughing)" are dropped and not investigated as spoken text. In total there were roughly 3.7 million words said. This corresponds to 475 hours of conversation or around four hours per episode.

```{r time_vs_words, echo = FALSE}

# read in data
actor_words_time <- read.csv(file = "./data/data_for_graphs/actor_words_time.csv")

# keep only the percentages and make into long format for easier plotting
actor_words_time <- actor_words_time %>%
  select(1, 4, 7) %>%
  pivot_longer(
    cols = c("time_percent", "words_percent"),
    names_to = "variable",
    values_to = "percent"
  )

# actual graph
actor_words_time %>%
  ggplot(aes(x = reorder(as.factor(actor_guest), percent), y = percent, fill = variable)) +
  geom_bar(stat = "identity", position = "dodge") +
  coord_flip() +
  scale_y_continuous(
    expand = c(0, 0),
    position = "right",
    breaks = c(seq(0, 80, 20)),
    labels = c(
      "0" = "0", "20" = "20",
      "40" = "40", "60" = "60%", "80"="80%"
    ),
    limits = c(0,80)
  ) +
  scale_fill_manual(
    breaks = c("time_percent", "words_percent"),
    values = c("#1b9e77", "#ffa600"),
    labels = c("Time", "Words")
  ) +
  labs(
    title = "Words and Time per Actor",
    subtitle = "In percent of the respective total.",
    caption = "Source: Critical-Role-Subtitles"
  ) +
  bar_chart_theme() +
  theme(
    legend.position = "bottom",
    legend.text = element_text(size = 5.5),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "line"),
    legend.key = element_blank(),
    legend.margin = margin(t = 0, unit = "cm")
  )

# save graph
ggsave("./output/pictures/graphs/time_words_per_actor.jpg", width = 4, height = 3)
```

Yet, we can still look at the most used words per actors to see if there some distinct words by the actors. There some differences become obvious. For example, the by now iconic "okay" used by Ashley can also be found in the data. Additionally, most players use words like going to indicate the actions that they like to do.

```{r log_odds, echo = FALSE}

# read in data
top_words_actor <- read.csv(file = "./data/data_for_graphs/top_words_actor.csv")


top_words_actor %>%
  ggplot(aes(x = reorder_within(word, percent, actor), y = percent)) +
  geom_bar(stat = "identity", fill = "#009E73") +
  coord_flip() +
  scale_y_continuous(expand = c(0, 0)) +
  facet_wrap(~actor, scales='free') +
  scale_x_reordered() +
  labs(
    title = "Top 5 Catch Words used by Cast*",
    subtitle = "Percent of total words used.",
    caption = "* as defined by log-odds,
Source: Critical-Role-Subtitles"
  ) + 
  bar_chart_theme() +
  theme(
    strip.background = element_rect(fill = "#F0F0F0"),
    panel.grid.major.x = element_line(size = rel(0.4), color = "#656565"),
    axis.line.y = element_line(size = rel(0.4), color = "black"),
    axis.text.x = element_text(color = "black", vjust = 5, size = rel(0.5), alpha(2)),
    axis.text.y = element_text(hjust = 1, color = "black", size = rel(0.75), margin = margin(r = -2)),
    strip.text = element_text(size = 5, face = "bold")
    )
    

ggsave("./output/pictures/graphs/top_words_per_actor.jpg", width = 4, height = 3)

```

Differences in words used between the cast members became obvious. We can use this to see, which cast member used the most elaborate vocabulary. Using an grade reading level index we can quantify this. As expected, Matt uses the most elaborate vocabulary. Additionally, one might argue that the vocabulary used correlates with the intelligence of the character played. However, Grog (played by Travis Willingham) seems to be the exception to the rule. While being the dumbest member of Vox Machina (as the characters call themselves), Pike (played by Ashley) seems to be using less expensive vocabulary. This may, however, be an artifact of the fact that Ashley is less present and Pike as a character rather shy. Hence, the low grade level.

```{r grade_level, echo = FALSE}

# read in data
readability <- read.csv(file = "./data/data_for_graphs/readability.csv")

# create graph
readability %>%
  ggplot(aes(x = reorder(actor_guest, Coleman.Liau.grade), y = Coleman.Liau.grade)) +
  geom_bar(stat = "identity", fill = "#1b9e77") +
  coord_flip() +
  scale_y_continuous(
    expand = c(0, 0),
    position = "left"
  ) +
  labs(
    title = "Grade Reading Levels",
    subtitle = "Mean Coleman and Liau (1975) Readbility Index*",
    caption = "*For Sentences longer than 5 Words.
       Source: Critical-Role-Subtitles"
  ) +
  bar_chart_theme()

# save
ggsave("./output/pictures/graphs/grades.jpg", width = 4, height = 3)
```

As Pike and Grog are best buddies it seems to be only fitting to look at the interaction between cast members. Indeed the second most character Ashley interacts with is Travis. He is only second to Laura, who has the most interactions with everybody. This indicates the findings from earlier, where Laura speaks shorter remarks compared to the rest. Indeed on average a segment from her only contains X words. The fact that Ashley sits next to Travis and Laura indicate that people sitting next to each other are more likely to interact with each other, as can be seen by the prevalence of interaction between Marisha and Taliesin. Moreover, in game relationship between characters become apparent to some extend. Liam interacts most with with his in game sister played by Laura and his love interest played by Marisha. Likewise, Taliesin interacts most with his in game love interest Laura. Again, similar to the analyses before there are some caveats to the results presented here. Interactions as presented in the graph are measure by when actors speak after each other. So they only give a rough estimate and actors giving one line off character comments may inflate the results.

```{r who_to_whom, echo = FALSE}

# read in data
network <- read.csv(file = "./data/data_for_graphs/network.csv")

# prepare network: nodes
nodes <- unique(network$from)

# combine network
network <- graph_from_data_frame(d = network, vertices = nodes, directed = T)

# graph the network
ggraph(network, layout = "circle") +
  geom_edge_link(aes(
    color = weights,
    alpha = weights,
    width = 1,
    start_cap = label_rect(node1.name),
    end_cap = label_rect(node2.name)
  )) +
  geom_node_text(aes(label = name),
                 size = 2
  ) +
  scale_edge_colour_gradient(
    low = "yellow",
    high = "red"
  ) +
  labs(
    title = "Who Speaks With Whom?",
    caption = "Source: Critical-Role-Subtitles"
  ) +
  base_theme() +
  theme(
    axis.line = element_blank(),
    axis.text.x = element_blank(),
    axis.text.y = element_blank(),
    axis.ticks = element_blank(),
    axis.title.x = element_blank(),
    panel.grid.major = element_blank(),
    plot.title = element_text(size = rel(0.5)),
    plot.caption = element_text(size = 3),
    legend.position = "none",
    plot.background = element_rect(fill = "#F0F0F0"),
    panel.background = element_rect(fill = "#F0F0F0")
  )

# save graph
ggsave("./output/pictures/graphs/who_speaks_with_whom.jpg", width = 4, height = 3)
```

However, one liners may not only come from on actor but multiple actors simultaneously. In the subtitles this may be shown by as follows: "Ashley and Laura: no no no no!". So lets see how has the same thoughts. Similarly, to the interactions earlier, we can see that Laura has indeed the most shared thoughts with her cast members, indicating that she indeed off character comments the most. Again, Marisha and Taliesin have the same ideas when it comes same thoughts. Similarly, the same applies to Ashley, Laura and Travis or Sam and Taliesin. It also becomes obvious that the cast is more likely to have the same thoughts as it rarely happens that guests save the same thing as the cast simultaneously.

```{r same_thought, echo = FALSE, error = TRUE}

# read in data
same_thought_network <- read.csv(file = "./data/data_for_graphs/same_thought_network.csv")

# prepare network: nodes
nodes_thought <- unique(same_thought_network$from)

# combine network
same_thought_network <- graph_from_data_frame(d = same_thought_network, vertices = nodes_thought, directed = T)

# graph the network
ggraph(same_thought_network, layout = "circle") +
  geom_edge_link(aes(
    color = weights,
    alpha = weights,
    width = 1,
    start_cap = label_rect(node1.name),
    end_cap = label_rect(node2.name)
  )) +
  geom_node_text(aes(label = name),
                 size = 2
  ) +
  scale_edge_colour_gradient(
    low = "yellow",
    high = "red"
  ) +
  labs(
    title = "Who Has the Same Thoughts?",
    caption = "Source: Critical-Role-Subtitles"
  ) +
  base_theme() +
  theme(
    axis.line = element_blank(),
    axis.text.x = element_blank(),
    axis.text.y = element_blank(),
    axis.ticks = element_blank(),
    axis.title.x = element_blank(),
    panel.grid.major = element_blank(),
    plot.title = element_text(size = rel(0.5)),
    plot.caption = element_text(size = 3),
    legend.position = "none",
    plot.background = element_rect(fill = "#F0F0F0"),
    panel.background = element_rect(fill = "#F0F0F0")
  )

# save graph
ggsave("./output/pictures/graphs/same_thought.jpg", width = 4, height = 3)
```

The text can also be used to examine, which character is the most happy or sad. To do so, dictionaries can be used, which assign words a positive (happy) or a negative (sad) value. These values can then be used to examine which characters are the most happy and sad. This will give you some indication, which character has the most happy or sad dialogues. So be wary of spoilers (and mimics) from now on.

Looking at the sentiment of the different actor some differences become apparent. One the one hand, Matt stands out as being the happiest of the bunch. This may likely be because he also has the most text and time he says while describing the scenes. Additionally, most of the NPC he describes are more of the happy type. Additionally, it becomes obvious that Liam plays the saddest character from the group. This maybe because he is always worried about his sister, his death. However, he also stated that dungeons and dragons serves as an outlet for him. Behind this background the score may be understandable. Personally, I found the high score for Marisha surprising as I remembered her to be a bit more reserved in the earlier episodes. But it looks like she made up for it in later Episodes (anybody remembers the wine incident?).

```{r sentiment_actor, echo = FALSE}
sentiment_actor <- read.csv(file = "./data/data_for_graphs/sentiment_by_actor.csv")

sentiment_actor %>% 
  filter(actor_guest != "Zac") %>% 
  filter(actor_guest != "Brian") %>% 
  filter(actor_guest != "Offscreen") %>% 
  ggplot(aes(x = reorder(actor_guest, mean_sentiment), y = mean_sentiment)) +
  geom_point(color = "#1b9e77", size = 2) +
  geom_errorbar(aes(ymin=mean_sentiment-1.95*sd_sentiment, 
                    ymax=mean_sentiment+1.95*sd_sentiment),
                color = "#1b9e77",
                size = 0.3,
                width=.2) +
  scale_y_continuous(breaks=c(-0.3,0.3,0.6)) + 
  geom_hline(yintercept = 0, size = 0.25) +
  labs(
    title = "Mean Sentiment Level per Actor",
    subtitle = "on a per sentence basis.",
    caption = "Source: Critical-Role-Subtitles"
  ) +
  coord_flip() +
  bar_chart_theme() 

# save graph
ggsave("./output/pictures/graphs/sentiment_actor.jpg", width = 4, height = 3)
```

The same methodology can be used to analyse the entire arcs. Looking at the data the values we can see that the first two arcs were happier compared to the middle ones. Later arcs became happier again. This also matches my personal experience from watching. After a happy start and everybody getting accustomed to streaming and watching dungeons and dragons on a live stream, the story took a darker turn with the Briarwoood arc. Afterwards, the attack of the Conclave also made for a dire mood. However, finding the vestiges gave the group some heroic moments and brighten the mood (anybody looking to buy some suude?). The following fight with Conclave and the fallout thereof let to some sweating moments for audience and actor alike. Before during the last two arcs loose ends were tied together.

```{r sentiment_arc, echo = FALSE}

sentiment_arc <- read.csv(file = "./data/data_for_graphs/sentiment_by_arc.csv")

sentiment_arc %>% 
  mutate(arc = str_replace(arc,"_"," ")) %>% 
  ggplot(aes(x = arc, y = mean_sentiment)) +
  geom_point(color = "#1b9e77", size = 2) +
  geom_errorbar(aes(ymin=mean_sentiment-1.95*sd_sentiment, 
                    ymax=mean_sentiment+1.95*sd_sentiment),
                color = "#1b9e77",
                size = 0.3,
                width=.2) +
  scale_y_continuous(breaks=c(-0.3,0.3,0.6)) + 
  geom_hline(yintercept = 0, size = 0.25) +
  labs(
    title = "Mean Sentiment Level per Arc",
    subtitle = "on a per sentence basis.",
    caption = "Source: Critical-Role-Subtitles"
  ) +
  coord_flip() +
  bar_chart_theme() 

# save graph
ggsave("./output/pictures/graphs/sentiment_arc.jpg", width = 4, height = 3)
```

So far we looked at the sentiment across arcs. Similarly to the comparison in miss spellings the comparison may not be fair. After all, if combat was more prevalent in one arc compared to another, chances of failure and character deaths are increased for this arc. So lets look at the length of combat and role playing for the different arcs. Interestingly, the time spent for both parts of the shows is rather constant across arcs and always around one to four. This probably mirrors the experience with many people playing a role play heavy campaign. However, this means that combat may not be the driving factor behind low sentiment scores but can be found in role play as well (Draconia anyone?). After all some funny moments were happening during combat as well (). This brings us to the more interesting question: which episodes are the most happy or sad, and thus worth a rewatch? Note: biggest spoilers ahead

```{r rp_combat, echo = FALSE}

# read in data
combat_rp_arc <- read.csv(file = "./data/data_for_graphs/combat_rp_arc.csv")

# graph
combat_rp_arc %>%
  ggplot(aes(x = reorder(arc, -arc_no), y = percent, fill = rp_combat)) +
  geom_bar(position = "stack", stat = "identity") +
  coord_flip() +
  scale_y_continuous(
    expand = c(0, 0),
    breaks = c(seq(0, 100, 25)),
    labels = c("0" = "0", "25" = "25", "50" = "50", "75" = "75", "100" = "100%"),
    position = "right"
  ) +
  scale_fill_manual(
    breaks = c("Role Play", "Combat"),
    values = c("#1b9e77", "#ffa600")
  ) +
  labs(
    title = "Combat vs. Role Play Time per Arc",
    subtitle = "In percent of total time.",
    caption = "Source: Critical Role Subtitles"
  ) +
  bar_chart_theme() +
  theme(
    legend.position = "bottom",
    legend.text = element_text(size = 5.5),
    legend.title = element_blank(),
    legend.key.height = unit(0.4, "line"),
    legend.key = element_blank(),
    legend.margin = margin(t = 0, unit = "cm")
  )

ggsave("./output/pictures/graphs/combat_vs_roleplay.jpg", width = 4, height = 3)
```

*note the numbers and content have to be checked again after numbers are fixed - 12 does not make sense*

Looking at the most fun episodes, it becomes obvious that second early episodes are the ones with best scores. Additionally, the other three of the top 5 episodes are from the same seventh arc, namely *Daring Deeds, Deals, and Destinies*. These include the first full episode of Sam's second character Taryon (86), Taryon and Grog's first ever shopping tour and the end of Keyleth's Arament√© (90) and the beach vacation (95).

In contrast, the bad episodes are more evenly distributed around arcs. The worst episode is 68, where the groupcatches up with Rippley and the Percy's past comes to a close. 114 is the second last episode where the story of Vox Machina comes to a close. Both 52 and 55 are episodes in the attack of the conclave arc. In 52 the group comes to the rescue of Grog after he is unable to defeat his uncle by himself. In 55 the group is facing off on the back of the ancient black dragon Umbrasyl in a fight for life and death. In 79, the party faces of against the head of the Chroma Conclave Thordak, in which Gilmore is badly wounded.

```{r sentiment_episodes, echo = FALSE}

sentiment_episode <- read.csv(file = "./data/data_for_graphs/sentiment_by_episode.csv")

sentiment_episode_graph <- sentiment_episode %>% 
  top_n(mean_sentiment, n=5) %>% 
  mutate(order = 6-row_number()) 

sentiment_episode_graph <- sentiment_episode %>% 
  top_n(-mean_sentiment, n=5) %>% 
  mutate(order = 6-row_number()) %>% 
  rbind(sentiment_episode_graph) %>% 
  mutate(type = "Best Episodes") %>% 
  mutate(type = replace(type,mean_sentiment<0.05,"Worst Episodes")) 

sentiment_episode_graph %>% 
  ggplot(aes(x = reorder(episode, order), y = mean_sentiment)) +
  geom_bar(stat = "identity", fill = "#009E73") +
  coord_flip() +
  facet_wrap(~type, scales='free_y') +
  scale_x_reordered() +
  scale_y_continuous(expand = c(0, 0)) +
  labs(
    title = "The 5 Best and Worst Episode by Sentiment",
    subtitle = "on a per sentence basis.",
    caption = "Source: Critical-Role-Subtitles"
  ) + 
  bar_chart_theme() +
  theme(
    strip.background = element_rect(fill = "#F0F0F0"),
    strip.text = element_text(size = rel(0.5)),
    axis.text.y = element_text(hjust = 1, color = "black", size = rel(0.75)),
    axis.text.x = element_text(color = "black", vjust =3, size = rel(0.75)),
    panel.grid.major.x = element_line(size = rel(0.4), color = "#656565"),
    panel.spacing = unit(2, "lines")
  )

# save graph
ggsave("./output/pictures/graphs/top_worst_5_episodes.jpg", width = 4, height = 3)
```

```{r correlates, echo=FALSE, warning=FALSE}

sentiment_episode <- read.csv(file = "./data/data_for_graphs/sentiment_by_episode.csv")

# correlation tests (to see if correlation is significant):
estimates = numeric(1)
pvalues = numeric(1)
names = character(1)

# calculate a correlation for each dice / face palm / Ashley variable: 
# with episode sentiment score and paste them into a new data frame
for (i in 4:9){
  j <- i-3
  tmp_df <- cor.test(sentiment_episode[,2], sentiment_episode[,i])
  names[j] <- names(sentiment_episode[i])
  estimates[j] = tmp_df$estimate
  pvalues[j] = tmp_df$p.value
}

correlation_test <-data.frame(names,estimates,pvalues) %>% 
  mutate(pvalues = round(pvalues, digits = 3))
rm(names,estimates,pvalues,tmp_df)


# change into wide format:
correlates_sentiment_episode <- sentiment_episode %>% 
  pivot_longer(pc_1:Ashley, names_to = "measure", values_to = "value") %>% 
  filter(measure != "Ashley") %>% 
  mutate(measure = str_replace(measure,"pc_1", "PC natural 1s"),
         measure = str_replace(measure,"pc_20", "PC natural 20s"),
         measure = str_replace(measure,"dm_1", "DM natural 1s"),
         measure = str_replace(measure,"dm_20", "DM natural 20s"),
         measure = str_replace(measure,"face_palms","Matt Face Palms"))                     
        
# graph
correlates_sentiment_episode %>% 
  ggplot(aes(x = value, y = mean_sentiment)) +
  geom_point(color = "#009E73", alpha = 0.5, size = 0.5) +
  geom_smooth(method = "lm", se=FALSE, color="black", size = 0.5) +
  facet_wrap(~measure, scales='free') + 
  stat_regline_equation(label.y = 0.095, label.x = 4, size=1.5, aes(label = ..rr.label..)) + 
  labs(
    title = "The 5 Best and Worst Episode by Sentiment",
    subtitle = "on a per sentence basis.",
    caption = "Source: Critical-Role-Subtitles"
  ) +
  bar_chart_theme() +
  theme(
    strip.background = element_rect(fill = "#F0F0F0"),
    strip.text = element_text(size = rel(0.5)),
    axis.line.y = element_blank(),
    panel.grid.major.y = element_line(size=.025, color="#656565"),  
    panel.grid.major.x = element_line(size=.025, color="#656565"),
    axis.text.y = element_text(hjust = 0, color = "black", size = rel(0.75)),
    axis.text.x = element_text(color = "black", vjust =3, size = rel(0.75)),
    panel.spacing = unit(1, "lines")
  )
# save graph
ggsave("./output/pictures/graphs/correlates_sentiment_episode.jpg", width = 4, height = 3)
```

Acknowledgements

-   [Critical Role](https://critrole.com/team/)

-   [Critical Role Transcript Team](https://crtranscript.tumblr.com/about)

-   [Critical Role Stats Team](https://www.critrolestats.com)

### References:

R. Rameshkumar and P. Bailey. Storytelling with Dialogue: A Critical Role Dungeons and Dragons Dataset. ACL 2020. Accessible at: [GitHub - RevanthRameshkumar/CRD3: The repo containing the Critical Role Dungeons and Dragons Dataset.](https://github.com/RevanthRameshkumar/CRD3)

### Licence:

This work is licensed under a [Creative Commons Attribution-ShareAlike 4.0 International License][cc-by-sa]
